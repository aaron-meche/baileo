import{byteLength as e}from"worktop/utils";var t="content-type",n="content-length",r={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",409:"Conflict",410:"Gone",411:"Length Required",413:"Payload Too Large",422:"Unprocessable Entity",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout"};function s(r,s,a){let o={};for(let e in a)o[e.toLowerCase()]=a[e];let d=o[t],i=typeof s;return null==s?s="":"object"===i?(s=JSON.stringify(s),d=d||"application/json;charset=utf-8"):"string"!==i&&(s=String(s)),o[t]=d||"text/plain",o[n]=o[n]||String(s.byteLength||e(s)),new Response(s,{status:r,headers:o})}var a=new Set([101,204,205,304]);function o(e,t){let r=a.has(e.status);if(!t&&!r)return e;let s=new Response(null,e);return r&&s.headers.delete(n),205===e.status&&s.headers.set(n,"0"),s}function d(){var e=this,r=e.headers=new Headers({"Cache-Control":"private, no-cache"});return e.body="",e.finished=!1,e.status=e.statusCode=200,e.getHeaders=()=>Object.fromEntries(r),e.getHeaderNames=()=>[...r.keys()],e.hasHeader=r.has.bind(r),e.getHeader=r.get.bind(r),e.removeHeader=r.delete.bind(r),e.setHeader=r.set.bind(r),Object.defineProperty(e,"status",{set:t=>{e.statusCode=t},get:()=>e.statusCode}),e.end=t=>{e.finished||(e.finished=!0,e.body=t)},e.writeHead=(t,n)=>{e.statusCode=t;for(let e in n)r.set(e,n[e])},e.send=(a,o,d)=>{let i,u,l=s(a,o,{[n]:e.getHeader(n),[t]:e.getHeader(t),...d});for([i,u]of l.headers)r.set(i,u);e.statusCode=l.status,e.end(l.body)},e}export{r as STATUS_CODES,d as ServerResponse,o as finalize,s as reply};