const { connect:e } = require('worktop/ws');function n(n){return function(o,t){let r=e(o);if(r)return r;let s={},{websocket:c,response:i}=Deno.upgradeWebSocket(o);function u(e){return n(o,t,{send:c.send.bind(c),close:c.close.bind(c),state:s,event:e})}return c.onopen=c.onmessage=u,c.onclose=c.onerror=async function(e){try{await u(e)}finally{c.close()}},i}}exports.listen=n;