import{lookup as e,mimes as t}from"mrmime";async function n(t,n){let r="string"==typeof n,s=!r&&"HEAD"===n.method;if(!(r||s||"GET"===n.method))return;let a=r?n:new URL(n.url).pathname;!r&&a.endsWith("/")&&(a+="index.html");let l=await t.get(a,"arrayBuffer");if(null==l)return new Response(null,{status:404});let i=a.lastIndexOf("."),o=~i?a.substring(++i):a,u=!r&&n.headers.get("range"),g=u?206:200,p=l.byteLength,c={"content-length":String(p)};if(o=o&&e(o),o&&(c["content-type"]=o),u){let[e,t]=u.replace("bytes=","").split("-"),n=parseInt(t,10)||p-1,r=parseInt(e,10)||0;if(r>=p||n>=p)return c["content-range"]=`bytes */${p}`,new Response(null,{status:416,headers:c});c["content-range"]=`bytes ${r}-${n}/${p}`,c["content-length"]=String(n-r+1),c["accept-ranges"]="bytes",l=l.slice(r,n)}return new Response(s?null:l,{status:g,headers:c})}export{t as mimes,n as serve};